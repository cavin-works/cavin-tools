# 任务完成指南

## 任务完成后必须执行的步骤

### 1. TypeScript 类型检查
运行 TypeScript 编译检查：
```bash
npx tsc --noEmit
```
确保没有类型错误。

### 2. 代码诊断
对修改的文件运行 LSP 诊断：
- 检查是否有错误、警告、提示
- 修复所有诊断问题

### 3. 构建验证
运行构建命令确保应用可以正常构建：
```bash
npm run build
```

### 4. 测试验证（如果适用）
如果添加或修改了代码，运行测试：
```bash
npm test
```

### 5. 代码风格检查
虽然没有配置 ESLint/Prettier，但应遵循项目的代码风格约定：
- 查看现有代码的格式
- 保持与现有代码风格一致

### 6. 提交规范

#### Commitlint 规则
项目使用 conventional commits，支持中文提交信息：

**格式**: `<type>(<scope>): <subject>`

**类型 (type)**:
- `feat` - 新功能
- `fix` - Bug 修复
- `docs` - 文档
- `style` - 格式（不影响代码运行）
- `refactor` - 重构
- `perf` - 性能优化
- `test` - 测试
- `chore` - 构建/工具
- `revert` - 回退

**示例**:
```
feat(video-editor): 添加视频截断功能
fix(image-converter): 修复转换后图片损坏的问题
docs: 更新 README 开发文档
style: 统一组件命名规范
refactor(core): 重构工具注册逻辑
perf(video): 优化视频编码性能
test: 添加视频编辑器单元测试
chore: 升级 React 到 18.3.1
```

#### 提交前检查
- 确保没有未完成的功能
- 确保没有调试代码（console.log、debugger 等）
- 确保所有修改已通过 TypeScript 类型检查
- 确保提交信息符合 commitlint 规范

### 7. 工具注册（添加新工具时）

如果是添加新工具，必须：
1. 在 `src/tools/` 下创建工具目录
2. 创建 `tool.config.ts` 并实现 `ToolMetadata` 接口
3. 在 `src/core/tool-registry/toolRegistry.ts` 中注册工具
4. 在 `src/core/tool-registry/toolRegistry.ts` 中更新分类（如果需要新分类）

### 8. 文档更新（如果需要）
- 如果修改了 API 或核心功能，更新相关文档
- 如果添加了新工具，更新 README 或相关文档

## 添加新功能的工作流程

1. **规划**: 确定功能需求和实现方案
2. **创建 TODO**: 使用 `todowrite` 创建任务列表
3. **实现**: 按照任务列表逐步实现
4. **验证**: 运行类型检查、构建、测试
5. **清理**: 移除调试代码、临时文件
6. **提交**: 遵循提交规范

## 修改现有功能的工作流程

1. **理解**: 阅读现有代码，理解实现逻辑
2. **修改**: 最小化修改，只修改必要的部分
3. **验证**: 确保修改没有破坏现有功能
4. **测试**: 运行相关测试（如果存在）
5. **提交**: 使用 `fix:` 或 `refactor:` 类型

## Bug 修复工作流程

1. **定位**: 找到问题根本原因
2. **修复**: 最小化修改，只修复 bug
3. **验证**: 确保 bug 已修复且无副作用
4. **提交**: 使用 `fix:` 类型，在提交信息中描述 bug

## 注意事项

- **不要重构**: Bug 修复时不要顺便重构，只修复 bug
- **不要修复无关问题**: 任务完成时不要修复其他未相关的 lint 错误
- **保持简洁**: 提交应该专注且最小化
- **验证后再提交**: 确保所有修改都可以正常工作

## 任务完成检查清单

- [ ] TypeScript 类型检查通过（无错误）
- [ ] LSP 诊断检查通过（无错误）
- [ ] 构建成功（npm run build）
- [ ] 测试通过（如果有相关测试）
- [ ] 代码风格符合项目约定
- [ ] 移除所有调试代码
- [ ] 提交信息符合 commitlint 规范
- [ ] 新工具已正确注册（如适用）
- [ ] 文档已更新（如需要）
